<!DOCTYPE html>

<head>
	<meta charset="utf-8">

	<style>
		button {
			position: fixed;
			top: 1em;
			width: 10em;
			left: calc(50% - 5em);
			font-size: 1.2em;
		}
	</style>
	
	<script src="suica.js"></script>
</head>

<body>
	<script>
		const HEIGHT = 1;
		const WIDTH = 0.3;
	</script>
	
	<suica fullWindow onTime="loop">
		<orbit distance="4" altitude="1" speed="0.5">
	</suica>
	
	<button onclick="saveModel()"><b>Save model</b><br><small>(as phalange4x1.glb)</small></button>
	
	<script>
		oxyz();
		
		ofsy = (HEIGHT-WIDTH)/2;
		
		body = cube( [0,ofsy,0], [WIDTH, HEIGHT-WIDTH], 'gray' );
		
		capu = cylinder( [0,HEIGHT/2-WIDTH/2+ofsy,-WIDTH/2], [WIDTH,WIDTH] );
		its.spinV = 90;
		
		capd = capu.clone;
		capd.y = -(HEIGHT-WIDTH)/2+ofsy;
		
		curve = sphere( [WIDTH*0,ofsy,0], [WIDTH*1.3, HEIGHT*1] );
		//curve = cylinder( [WIDTH*0,-HEIGHT*1.1/2+ofsy,0], [WIDTH*1.4, HEIGHT*1.1] );

		axisu = prism( 20, [0,HEIGHT/2-WIDTH/2+ofsy,-2], [WIDTH*1.3/3,4] );
		its.spinV = 90;
		
		axisd = axisu.clone;
		its.y = -(HEIGHT-WIDTH)/2+ofsy;
		its.spinV = 90;
		
		cutu1 = prism( 20, [0,HEIGHT/2-WIDTH/2+ofsy,0.5*0.34*WIDTH], WIDTH, 'yellow' );
			its.spinV = 90;
			
		cutu2 = cutu1.clone;
			its.spinV = -90;
			its.z -= 2*0.5*0.34*WIDTH;
			
		cutu3 = cube( [WIDTH/2,HEIGHT/2-WIDTH/2+ofsy,0.5*0.34*WIDTH+WIDTH/2], WIDTH, 'yellow' );
		cutu4 = cube( [WIDTH/2,HEIGHT/2-WIDTH/2+ofsy,-0.5*0.34*WIDTH-WIDTH/2], WIDTH, 'yellow' );

		cutd = prism( 20, [0,-(HEIGHT/2-WIDTH/2)+ofsy,-0.5*0.4*WIDTH], [WIDTH,0.4*WIDTH], 'yellow' );
			its.spinV = 90;
	
		g = group(body,capu,capd,curve,axisu,axisd,cutd,cutu1,cutu2,cutu3,cutu4);
			its.visible = false;
		
		phalange = construct( '(body+capu+capd)*curve - (axisu+axisd) - (cutu3+cutu4) - (cutu1+cutu2+cutd)' );
			its.color = 'white';


		phalange2 = phalange.clone;
			its.y = -(HEIGHT-WIDTH);
			its.spinS = 0;
			its.color="dimgray";


		function loop( t )
		{
			phalange.spinS = -45+45*Math.sin(t);
		}
		
		
		function saveModel()
		{
			phalange.spinS = 0;
			model.save( 'phalange4x1.glb', [phalange] );
		}
	</script>
</head>
